---

- hosts: localhost
  remote_user: root
  gather_facts: true

  vars:
    sssd_from_sources: true
    sssd_version: !!str 1_16_1
    sssd_patches:
      add_libsss_child_la_to_makefile:
        dest_file: Makefile.am
        patch_file: add_libsss_child.la_to_makefile.patch
        state: present
    sssd_config_type: config
    sssd_config:
      'domain/example.com':
        access_provider: permit
        auth_provider: local
        id_provider: local
      sssd:
        config_file_version: 2
        domains: example.com
      nss:
        filter_groups: root
        filter_users: root
        homedir_substring: /home
      session_recording:
        scope: all

  roles:
    - timorunge.sssd
